"""
Test calculus
"""

O1 = seq"L1:L5:R5:R1"
OA = seq"L1:x1(0):R2:x2(0):L5:R5:x2(U):L2:x1(U):R1"


@testset "calc" begin
    C = calc"R2o(L1f)#L2u(R5n)"
    @test C(O1) == OA
    O1b = pass"R2o(L1f)"(O1)
    @test O1b == seq"L1:x1(0):R2:x2(0):L5:R5:x2(U):x1(U):R1"
    @test pass"L2u(R5n)"(O1b) == seq"L1:x1(0):R2:x2(0):L5:R5:x2(U):L2:x1(U):R1"
end

@testset "procedure" begin
    @test O1 == proc"O1::" |> only
    @test OA == proc"OA::" |> only
    @test pass"R2o(L1f)"(O1) == proc"O1::R2o(L1f)" |> last
    fig29VI = proc"OA::DL1#DR1|L1u(L5f)#R1u(R5f)#L1o(L2f)#R1o(R2f)#DL5#DR5|L5o(L1f)#R5o(R1f)#"
    @test collect(fig29VI) == [seq"L1:x1(0):R2:x2(0):L5:R5:x2(U):L2:x1(U):R1",
        seq"L2:x1(U):R5:L5:x1(0):R2:x2(0):R1:x2(U)",
        seq"L2:x1(U):R5:L5:x1(0):R2:x2(0):x2(U)",
        seq"L2:x1(U):R5:L5:x1(0):R2",
        seq"x6(0):x7(0):L2:x5(0):x4(0):x1(U):R5:x2(U):x4(U):x6(U):L1:x7(U):x5(U):x3(U):L5:x3(0):x2(0):x1(0):R2",
        seq"x13(0):x12(0):x6(0):x7(0):L2:x5(0):x4(0):x1(U):x8(0):x9(0):R5:x9(U):x11(U):x13(U):R1:x12(U):x10(U):x8(U):x2(U):x4(U):x6(U):L1:x7(U):x5(U):x3(U):L5:x3(0):x2(0):x1(0):x10(0):x11(0):R2",
        seq"x13(0):x12(0):x6(0):x7(0):x14(U):x15(U):L2:x15(0):L1.1:x14(0):x5(0):x4(0):x1(U):x8(0):x9(0):R5:x9(U):x11(U):x13(U):R1:x12(U):x10(U):x8(U):x2(U):x4(U):x6(U):L1:x7(U):x5(U):x3(U):L5:x3(0):x2(0):x1(0):x10(0):x11(0):R2",
        seq"x17(U):x16(U):x13(0):x12(0):x6(0):x7(0):x14(U):x15(U):L2:x15(0):L1.1:x14(0):x5(0):x4(0):x1(U):x8(0):x9(0):R5:x9(U):x11(U):x13(U):R1:x12(U):x10(U):x8(U):x2(U):x4(U):x6(U):L1:x7(U):x5(U):x3(U):L5:x3(0):x2(0):x1(0):x10(0):x11(0):x16(0):R1.1:x17(0):R2",
        seq"L1:x1(U):x2(U):x3(U):x3(0):x4(0):x5(0):x6(0):x7(0):x8(0):R1.1:x9(0):R2:x9(U):x8(U):x10(0):x11(0):x12(0):x1(0):x13(U):x14(U):L2:x14(0):L1.1:x13(0):x2(0):x15(0):x5(U):x16(0):x17(0):R5:x17(U):x7(U):x10(U):R1:x11(U):x6(U):x16(U):x4(U):x15(U):x12(U)",
        seq"L1:x1(U):x2(U):x3(U):x3(0):x4(0):x5(0):x6(0):x7(0):x8(0):R1.1:x9(0):R2:x9(U):x8(U):x10(0):x11(0):x12(0):x1(0):x13(U):x14(U):L2:x14(0):L1.1:x13(0):x2(0):x15(0):x5(U):x16(0):x17(0):x17(U):x7(U):x10(U):R1:x11(U):x6(U):x16(U):x4(U):x15(U):x12(U)",
        seq"L1:x1(U):x2(U):x3(0):x4(0):x5(0):x6(0):x7(0):R1.1:x8(0):R2:x8(U):x7(U):x9(0):x10(0):x11(0):x1(0):x12(U):x13(U):L2:x13(0):L1.1:x12(0):x2(0):x14(0):x4(U):x15(0):x6(U):x9(U):R1:x10(U):x5(U):x15(U):x3(U):x14(U):x11(U)",
        seq"L1:x17(0):x19(0):x21(0):x23(0):L5:x22(0):x20(0):x18(0):x16(0):x1(U):x2(U):x3(0):x4(0):x5(0):x6(0):x7(0):R1.1:x8(0):R2:x8(U):x7(U):x9(0):x10(0):x11(0):x1(0):x12(U):x13(U):x20(U):x21(U):L2:x23(U):x22(U):x13(0):x18(U):x19(U):L1.1:x17(U):x16(U):x12(0):x2(0):x14(0):x4(U):x15(0):x6(U):x9(U):R1:x10(U):x5(U):x15(U):x3(U):x14(U):x11(U)",
        seq"L1:x17(0):x19(0):x21(0):x23(0):L5:x22(0):x20(0):x18(0):x16(0):x1(U):x2(U):x3(0):x4(0):x5(0):x6(0):x7(0):x24(U):x25(U):R1.1:x27(U):x26(U):x8(0):x30(U):x31(U):R2:x29(U):x28(U):x8(U):x7(U):x9(0):x10(0):x11(0):x1(0):x12(U):x13(U):x20(U):x21(U):L2:x23(U):x22(U):x13(0):x18(U):x19(U):L1.1:x17(U):x16(U):x12(0):x2(0):x14(0):x4(U):x15(0):x6(U):x9(U):x24(0):x26(0):x28(0):x30(0):R5:x31(0):x29(0):x27(0):x25(0):R1:x10(U):x5(U):x15(U):x3(U):x14(U):x11(U)"]
end